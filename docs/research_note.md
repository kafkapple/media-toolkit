# Social Media Collector 연구 노트

## 1. 프로젝트 개요

본 프로젝트는 개인 지식 관리 시스템(PKM)인 Obsidian과 연동하여, 소셜 미디어(Instagram, Facebook 등)의 휘발성 콘텐츠를 영구적으로 아카이빙하고 관리하기 위해 시작되었습니다. 단순한 스크래핑을 넘어, 개인의 관점이 담긴 '주석(Note)'과 함께 데이터를 보존하는 것을 목표로 합니다.

## 2. 주요 기술적 과제 및 해결

### 2.1 인증 및 접근 제한 (Authentication & Rate Limiting)
- **문제**: Instagram 및 Facebook은 로그인 없이는 데이터 접근이 매우 제한적이며, 특히 미디어 다운로드는 세션 쿠키 없이는 불가능한 경우가 많음 (Login Required, 403 Forbidden). 비공개 그룹이나 성인 인증이 필요한 콘텐츠는 기존의 단순 다운로더로는 접근이 불가능했습니다.
- **해결**: `yt-dlp`의 강력한 기능인 `--cookies-from-browser` 옵션을 활용했습니다. 사용자가 평소 사용하는 로컬 브라우저(Chrome, Safari 등)의 인증 세션(쿠키)을 그대로 빌려와 요청을 보냄으로써, 별도의 복잡한 로그인 구현 없이도 안전하고 확실하게 인증을 통과할 수 있었습니다. 이는 계정 차단 리스크를 줄이고 유지보수성을 높이는 결정적인 한 수였습니다.

### 2.2 대량의 URL 관리 및 중복 제거
- **문제**: 수백 개의 Markdown 파일에 산재된 URL을 수집하면 필연적으로 중복이 발생합니다. 또한 소셜 미디어 URL은 `igsh=...`, `ref=...` 등 무의미한 추적 파라미터가 붙어 있어 같은 게시물도 다른 URL로 인식될 수 있습니다.
- **해결**: 정규식을 통한 URL 정규화(Normalization) 과정을 도입하여 순수 식별자(Slug/ID)만을 추출하고, 이를 SHA-256 해싱하여 고유 ID(fingerprint)를 생성했습니다. 이를 통해 파일이 달라도, URL 형태가 조금 달라도 같은 게시물임을 정확히 식별하여 중복 처리를 방지했습니다.

### 2.3 로컬 파일 시스템과 웹 UI의 통합 (User Experience)
- **문제**: 웹 브라우저 환경(Viewer)은 보안 샌드박스 정책으로 인해 사용자의 로컬 파일 시스템에 직접 접근(탐색기 열기 등)하는 것이 불가능합니다. 하지만 사용자는 다운로드된 고화질 원본 파일을 로컬 뷰어로 보고 싶어 합니다.
- **해결**: Python Backend(FastAPI)가 OS의 네이티브 명령(`open` on Mac, `start` on Windows, `xdg-open` on Linux)을 실행하는 중계 API(`/api/open/{id}`)를 제공했습니다. 웹 UI에서 버튼을 클릭하면 백엔드로 요청을 보내고, 백엔드가 실제로 폴더를 여는 방식입니다. 이를 통해 웹과 로컬 앱의 경계를 허무는 매끄러운 사용자 경험을 제공했습니다.

## 3. 데이터 구조 설계 (Schema Design)

유연성과 확장성을 위해 JSON 기반의 Flat-file DB 구조를 채택했습니다.
- **Posts**: 개별 파일(`data/posts/{id}.json`)로 저장하여 데이터 손상 범위를 최소화하고, Git 등 버전 관리 시스템과의 호환성을 고려했습니다.
- **Indexing**: 전체 데이터를 매번 로드하는 비효율을 막기 위해 `index.json`에 필수 메타데이터(날짜, 상태, 플랫폼 등)만 요약하여 저장, 빠른 필터링과 정렬을 지원했습니다.
- **Media Organization**: 초기에는 단일 폴더(`media/`)에 모든 파일을 저장했으나, 파일 수가 수천 개로 늘어날 것을 대비해 `media/{author}/{title}-{id}.ext` 구조로 개편했습니다. 이는 사용자가 탐색기에서도 직관적으로 파일을 찾고 관리할 수 있게 해줍니다.

## 4. 향후 연구 및 확장 방향

- **AI 기반 자동 태깅**: 수집된 이미지/텍스트를 LLM이나 Vision 모델에 전달하여 자동으로 태그를 생성하고 분류하는 기능.
- **Notion/Obsidian 역방향 동기화**: 수집된 메타데이터(좋아요 수, 요약 등)를 다시 원본 Markdown 파일에 업데이트하는 양방향 동기화 (Back-sync).
- **Full-text Search**: 현재의 단순 매칭을 넘어선 Elasticsearch/Meilisearch 수준의 검색 엔진 도입 고려.
